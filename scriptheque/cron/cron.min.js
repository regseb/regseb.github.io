//Cron-0.1|github.com/regseb/scriptheque/cron
(function(){window.setCron=function(a,b){var f=(++n).toString();e[f]={conds:p(b),func:a,args:Array.prototype.slice.call(arguments,2)};null===g&&(g=setInterval(function(){var a=new Date,b;for(b in e){var c=e[b];d(c.conds[0],a.getMinutes())&&d(c.conds[1],a.getHours())&&(d(c.conds[2],a.getDay())||0===a.getDay()&&d(c.conds[2],7))&&d(c.conds[3],a.getMonth()+1)&&d(c.conds[4],a.getDate())&&c.func.apply(window,c.args)}},6E4));return f};window.clearCron=function(a){delete e[a];0===Object.keys(e).length&&(clearInterval(g), g=null)};var n=0,e={},g=null,d=function(a,b){for(var f in a){var h=a[f];if(h.min<=b&&b<=h.max&&0===(b-h.min)%h.step)return!0}return!1},p=function(a){switch(a){case "@yearly":case "@annually":a="0 0 1 1 *";break;case "@monthly":a="0 0 1 * *";break;case "@weekly":a="0 0 * * 0";break;case "@daily":case "@midnight":a="0 0 * * *";break;case "@hourly":a="0 * * * *"}var b=a.split(" ");if(5!==b.length)throw Error("Syntax error, 5 fields (separated by one space) expected: '"+a+"'");b[3]=b[3].replace(/jan/gi, "1").replace(/feb/gi,"2").replace(/mar/gi,"3").replace(/apr/gi,"4").replace(/may/gi,"5").replace(/jun/gi,"6").replace(/jul/gi,"7").replace(/aug/gi,"8").replace(/sep/gi,"9").replace(/oct/gi,"10").replace(/nov/gi,"11").replace(/dec/gi,"12");b[4]=b[4].replace(/sun/gi,"0").replace(/mon/gi,"1").replace(/tue/gi,"2").replace(/wed/gi,"3").replace(/thu/gi,"4").replace(/fri/gi,"5").replace(/sat/gi,"6");var f=[],h;for(h in b){var d=b[h].split(","),c=[],e;for(e in d){var k=/^(\*|\d+)(-\d+)?(\/\d+)?$/.exec(d[e]); if(null===k)throw Error("Syntax error: '"+a+"'");var g=0,l=Infinity,m=1;"*"!==k[1]&&(g=l=parseInt(k[1],10));void 0!==k[2]&&(l=parseInt(k[2].substr(1),10));void 0!==k[3]&&(m=parseInt(k[3].substr(1),10));c.push({min:g,max:l,step:m})}f.push(c)}return f}})();